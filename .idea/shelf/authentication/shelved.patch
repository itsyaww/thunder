Index: thundersite/thunderapp/models.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from django.db import models\n\n\nclass User(models.Model):\n\n    name = models.CharField(max_length=30, null=False)\n    dateOfBirth = models.DateField(max_length=8, null=False,default='YYYY-MM-DD')\n    gender = models.DecimalField(decimal_places=2, max_digits=6,null=True)\n    profileImage = models.ImageField(upload_to='profile_images', default=None)\n    email = models.EmailField(max_length=254, default='unknown@unknown.com')\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/models.py	(revision f00ba3a4660a2efa0526d21c48dc670c7dfac6be)
+++ thundersite/thunderapp/models.py	(date 1542389600000)
@@ -1,9 +1,9 @@
 from django.db import models
 
 
-class User(models.Model):
+class Member(models.Model):
 
-    name = models.CharField(max_length=30, null=False)
+    username = models.CharField(max_length=30, null=False)
     dateOfBirth = models.DateField(max_length=8, null=False,default='YYYY-MM-DD')
     gender = models.DecimalField(decimal_places=2, max_digits=6,null=True)
     profileImage = models.ImageField(upload_to='profile_images', default=None)
Index: thundersite/thunderapp/templates/thunderapp/signup.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/templates/thunderapp/signup.html	(date 1542390553000)
+++ thundersite/thunderapp/templates/thunderapp/signup.html	(date 1542390553000)
@@ -0,0 +1,18 @@
+{% load staticfiles %}
+
+{% block signup %}
+   <div class='main'>
+      <h3>Please enter your details to sign up</h3>
+      <form method='POST'>
+      	{% csrf_token %}
+         <span class='fieldname'>Username</span>
+         <input type='text' maxlength='16' id='regusername' name='username'>
+            <span id='info'></span>
+            <br>
+            <span class='fieldname'>Password</span>
+            <input type='password' maxlength='16' name='password'><br>
+            <span class='fieldname'>&nbsp;</span>
+         <input type='submit' value='Sign up'>
+      </form>
+   </div>
+{% endblock %}
Index: thundersite/thunderapp/templates/thunderapp/index.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/templates/thunderapp/index.html	(date 1542391472000)
+++ thundersite/thunderapp/templates/thunderapp/index.html	(date 1542391472000)
@@ -0,0 +1,17 @@
+
+{% block content %}
+	<span class='info'>&#8658; You must be logged in to view this page.</span>
+	<br>
+	<br>
+	<br>
+	<span class='main'>
+		Welcome to {{ appname }}, please sign up and/or log in to join in.
+	</span>
+<br>
+
+<a href="/signup">Signup</a>
+<br>
+<a href="/login">Login</a>
+
+	<br>
+{% endblock %}
Index: thundersite/thunderapp/templates/thunderapp/user-registered.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/templates/thunderapp/user-registered.html	(date 1542391107000)
+++ thundersite/thunderapp/templates/thunderapp/user-registered.html	(date 1542391107000)
@@ -0,0 +1,10 @@
+
+{% block content %}
+<span class='info'>&#8658; You must be logged in to view this page.</span>
+<br>
+<br>
+<div class='main'><h3>Please enter your details to sign up</h3>
+<h4>Account for user {{ username }} created.</h4>
+Please Log in.
+</div>
+{% endblock %}
Index: thundersite/thunderapp/templates/thunderapp/base.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{% load staticfiles %}\n\n<html lang=\"en\">\n    <head>\n        <!-- Required meta tags -->\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n\n        <!-- Bootstrap CSS -->\n        <link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css\" integrity=\"sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO\" crossorigin=\"anonymous\">\n\n        <title>Thunder Site</title>\n    </head>\n    <body>\n        <nav class=\"navbar navbar-expand-md navbar-dark bg-danger sticky-top\">\n            <button class=\"navbar-toggler\" data-toggle=\"collapse\" data-target=\"#collapse_target\">\n                <span class=\"navbar-toggler-icon\"></span>\n            </button>\n\n            <div class=\"collapse navbar-collapse\" id=\"collapse_target\">\n                <a class=\"navbar-brand\"><img scr=\"{%  static 'thunderlogo.jpg' %}\"></a>\n                <span class=\"navbar-text\">Thunder</span>\n                <ul class=\"navbar-nav\">\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"#\">Link 1</a>\n                    </li>\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"#\">Link 2</a>\n                    </li>\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"#\">Link 3</a>\n                    </li>\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"#\">Link 4</a>\n                    </li>\n                </ul>\n            </div>\n        </nav>\n        <div class=\"jumbotron\" style=\"margin-bottom: 0px;\">\n            <h1>Thunder</h1>\n            <p>Matching you to the right one.</p>\n        </div>\n\n        <h1>Hello, world!</h1>\n\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi id libero quam. Sed eu imperdiet ipsum. Fusce sit amet sem ullamcorper, sagittis nibh at, tincidunt ipsum. Curabitur tempor vehicula dolor, eget eleifend urna ullamcorper eget. Integer mollis magna eu odio mollis, in commodo dolor elementum. Curabitur consequat congue ipsum vitae interdum. Proin finibus metus nulla, nec feugiat tortor auctor sed. Morbi et ex iaculis, laoreet ante vel, tincidunt orci. Mauris sit amet volutpat sapien. Phasellus tempor venenatis nisl in elementum. Nullam eget neque id nibh accumsan condimentum sed ut tellus.\n\n        Vivamus nisl nisi, pulvinar in consequat id, fringilla ut lectus. Ut sed lacus a lorem cursus suscipit et eu dolor. Etiam quis risus nec sem volutpat gravida. Sed eu orci purus. Duis quis mattis massa. Sed pellentesque mauris vel porta interdum. Maecenas eu purus et velit vestibulum viverra. Pellentesque venenatis rutrum molestie. Nunc ac accumsan erat. Pellentesque viverra egestas mi a malesuada. Aliquam erat volutpat. Suspendisse eu congue nisl. Nulla a fermentum turpis, eget lacinia enim. Mauris semper viverra justo vel finibus.\n\n        In hac habitasse platea dictumst. Nullam tincidunt nulla lobortis, faucibus nisi sit amet, porttitor purus. Phasellus ullamcorper nibh sed sem accumsan, in ultrices quam varius. Fusce vestibulum, leo a suscipit rutrum, diam eros efficitur nibh, eu ultrices magna mi eu urna. Sed efficitur est sed tristique feugiat. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec sem orci, ullamcorper in quam nec, malesuada ullamcorper leo.\n\n        Integer ornare mi ac nulla volutpat, iaculis bibendum felis scelerisque. Maecenas id aliquam massa. Maecenas quis odio et mi placerat feugiat. Vivamus id tellus sit amet lorem feugiat rhoncus condimentum et dolor. Proin egestas neque eleifend erat volutpat elementum. Proin dictum auctor tellus vitae lobortis. Mauris tempor orci a volutpat pellentesque.\n\n        Etiam vitae nibh pharetra, varius metus ut, lacinia libero. Nulla ut vehicula massa, ut pharetra eros. Phasellus faucibus ligula a ante condimentum, vitae pellentesque nisi gravida. Morbi suscipit purus eget mollis pellentesque. Suspendisse non lectus eu orci laoreet tempus a in orci. Nam vitae leo at dui bibendum feugiat. Proin dictum dictum nisl, sed mattis sem porta sed. Donec in lectus in nulla congue ornare. Quisque ac dignissim nulla. Nunc egestas volutpat nulla, at faucibus tellus tincidunt mollis. Morbi porttitor neque quis ipsum ornare posuere. Morbi ultrices volutpat viverra.\n\n    <!-- Optional JavaScript -->\n    <!-- jQuery first, then Popper.js, then Bootstrap JS -->\n    <script src=\"https://code.jquery.com/jquery-3.3.1.min.js\"></script>\n    <script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js\" integrity=\"sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy\" crossorigin=\"anonymous\"></script>\n    </body>\n</html>\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/templates/thunderapp/base.html	(revision f00ba3a4660a2efa0526d21c48dc670c7dfac6be)
+++ thundersite/thunderapp/templates/thunderapp/base.html	(date 1542880374000)
@@ -53,9 +53,32 @@
 
         Etiam vitae nibh pharetra, varius metus ut, lacinia libero. Nulla ut vehicula massa, ut pharetra eros. Phasellus faucibus ligula a ante condimentum, vitae pellentesque nisi gravida. Morbi suscipit purus eget mollis pellentesque. Suspendisse non lectus eu orci laoreet tempus a in orci. Nam vitae leo at dui bibendum feugiat. Proin dictum dictum nisl, sed mattis sem porta sed. Donec in lectus in nulla congue ornare. Quisque ac dignissim nulla. Nunc egestas volutpat nulla, at faucibus tellus tincidunt mollis. Morbi porttitor neque quis ipsum ornare posuere. Morbi ultrices volutpat viverra.
 
-    <!-- Optional JavaScript -->
+
+
+        {% if loggedin %}
+        <div class='appname'>{{ appname }} ({{ username }}) </div>
+        {% else %}
+        <div class='appname'>{{ appname }}</div>
+        {% endif %}
+        <br>
+
+        <br>
+        {% block signup %}
+        {% include "thunderapp/signup.html" %}
+        {% endblock %}
+
+        {% block login %}
+        {% include "thunderapp/login.html" %}
+        {% endblock %}
+        <br>
+
+
+
+        <!-- Optional JavaScript -->
     <!-- jQuery first, then Popper.js, then Bootstrap JS -->
     <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
+    <script type="text/javascript" src="{% static 'register.js' %}"></script>
+
     <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
     </body>
 </html>
Index: thundersite/thunderapp/templates/thunderapp/login.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/templates/thunderapp/login.html	(date 1542391107000)
+++ thundersite/thunderapp/templates/thunderapp/login.html	(date 1542391107000)
@@ -0,0 +1,25 @@
+
+{% load staticfiles %}
+
+{% block login %}
+   <div class='main'>
+       {% if loggedin %}
+           You are now logged in.
+           Please <a href="{% url 'messages'%}">click here</a> to continue.
+           <br><br>
+       {% else %}
+           <h3>Please enter your details to login</h3>
+           <form method='POST'>
+           	{% csrf_token %}
+               <span class='fieldname'>Username</span>
+               <input type='text' maxlength='16' id='logusername' name='username'>
+               <span id='info'></span>
+               <br>
+               <span class='fieldname'>Password</span>
+               <input type='password' maxlength='16' name='password'><br>
+               <span class='fieldname'>&nbsp;</span>
+               <input type='submit' value='Login'>
+           </form>
+       {% endif %}
+   </div>
+{% endblock %}
Index: thundersite/thunderapp/static/register.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/static/register.js	(date 1542395541000)
+++ thundersite/thunderapp/static/register.js	(date 1542395541000)
@@ -0,0 +1,1 @@
+$('#regusername').blur(function() { f('register'); });
Index: thundersite/thunderapp/urls.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from django.urls import path\n\nfrom thunderapp import views\n\n\napp_name = 'thunderapp'\nurlpatterns = [\n                  path('home/', views.home, name='home'),\n\n]
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/urls.py	(revision f00ba3a4660a2efa0526d21c48dc670c7dfac6be)
+++ thundersite/thunderapp/urls.py	(date 1542389758000)
@@ -5,6 +5,11 @@
 
 app_name = 'thunderapp'
 urlpatterns = [
-                  path('home/', views.home, name='home'),
+    path('', views.index, name='index'),
+    path('home/', views.home, name='home'),
+    path('signup/', views.signup, name='signup'),
+
+    path('register/', views.register, name='register'),
+    path('login/', views.login, name='login'),
 
 ]
\ No newline at end of file
Index: thundersite/thunderapp/admin.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from django.contrib import admin\n\n# Register your models here.\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/admin.py	(revision f00ba3a4660a2efa0526d21c48dc670c7dfac6be)
+++ thundersite/thunderapp/admin.py	(date 1542396534000)
@@ -1,3 +1,11 @@
 from django.contrib import admin
 
-# Register your models here.
+from .models import Member
+
+
+class AdminMember(admin.ModelAdmin):
+    list_display = ['username', 'dateOfBirth', 'gender', 'profileImage', 'email']
+    list_display_links = ['username']
+
+
+admin.site.register(Member, AdminMember)
\ No newline at end of file
Index: thundersite/thunderapp/views.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from django.shortcuts import render, get_object_or_404\nfrom django.views.decorators.csrf import csrf_exempt\n\n\n@csrf_exempt\ndef home(request):\n    return render(request, 'thunderapp/base.html', {})
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- thundersite/thunderapp/views.py	(revision f00ba3a4660a2efa0526d21c48dc670c7dfac6be)
+++ thundersite/thunderapp/views.py	(date 1542390888000)
@@ -1,7 +1,74 @@
-from django.shortcuts import render, get_object_or_404
-from django.views.decorators.csrf import csrf_exempt
+from django.shortcuts import render
+from django.http import Http404
+from .models import Member
+from django.db import IntegrityError
+
 
+# datetime library to get time for setting cookie
+import datetime as D
 
-@csrf_exempt
+appname = 'Thunder'
+
+
 def home(request):
-    return render(request, 'thunderapp/base.html', {})
\ No newline at end of file
+    return render(request, 'thunderapp/base.html', {})
+
+
+def index(request):
+    context = { 'appname': appname }
+    return render(request,'thunderapp/index.html',context)
+
+
+def signup(request):
+    context = { 'appname': appname }
+    return render(request,'thunderapp/signup.html',context)
+
+
+def login(request):
+    if not ('username' in request.POST and 'password' in request.POST):
+        context = { 'appname': appname }
+        return render(request,'thunderapp/login.html',context)
+    else:
+        username = request.POST['username']
+        password = request.POST['password']
+        try: member = Member.objects.get(username=username)
+        except Member.DoesNotExist: raise Http404('User does not exist')
+        if member.check_password(password):
+            # remember user in session variable
+            request.session['username'] = username
+            request.session['password'] = password
+            context = {
+                'appname': appname,
+                'username': username,
+                'loggedin': True
+            }
+            response = render(request, 'thunderapp/login.html', context)
+            # remember last login in cookie
+            now = D.datetime.utcnow()
+            max_age = 365 * 24 * 60 * 60  #one year
+            delta = now + D.timedelta(seconds=max_age)
+            format = "%a, %d-%b-%Y %H:%M:%S GMT"
+            expires = D.datetime.strftime(delta, format)
+            response.set_cookie('last_login',now,expires=expires)
+            return response
+        else:
+            raise Http404('Wrong password')
+
+
+def register(request):
+    if 'username' in request.POST and 'password' in request.POST:
+        u = request.POST['username']
+        p = request.POST['password']
+        user = Member(username=u)
+        user.set_password(p)
+        try: user.save()
+        except IntegrityError: raise Http404('Username '+u+' already taken: Usernames must be unique')
+        context = {
+            'appname' : appname,
+            'username' : u
+        }
+        return render(request,'thunderapp/user-registered.html',context)
+
+    else:
+        raise Http404('POST data missing')
+
